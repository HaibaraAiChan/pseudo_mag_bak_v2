main start at this time 1634599843.9933193
Namespace(R=5, aggre='lstm', batch_size=157393, data_cpu=False, dataset='ogbn-mag', dropout=0.5, eval_batch_size=100000, eval_every=5, fan_out='10', gpu=0, inductive=False, log_every=5, lr=0.003, num_epochs=30, num_hidden=16, num_layers=1, num_workers=4, seed=1236, selection_method='range', weight_decay=0)
load ogbn-mag
-------------------------------------------------------------data = DglNodePropPredDataset(name=name)***************************

 step Time(s): 0.5208
finish loading ogbn-mag
target_type_id  3
counts tensor([1134649,   59965,    8740,  736389])
len(paper label)
736389
{'train': {'paper': tensor([     0,      1,      2,  ..., 736386, 736387, 736388])}, 'valid': {'paper': tensor([   332,    756,    784,  ..., 736364, 736367, 736370])}, 'test': {'paper': tensor([   359,    411,    608,  ..., 736358, 736384, 736385])}}
# total Nodes: 1939743
# total Edges: 42222014
# paper graph Labels: 736389
# paper graph Train: 629571
# paper graph Val: 64879
# paper graph Test: 41939
# paper graph Classes: 349
Compute neighbor-averaged feats
in_feats
128
feats
6
torch.Size([736389, 128])
train_nfeat
tensor([[-0.0954,  0.0408, -0.2109,  ...,  0.0616, -0.0277, -0.1338],
        [-0.1510, -0.1073, -0.2220,  ...,  0.3458, -0.0277, -0.2185],
        [-0.1148, -0.1760, -0.2606,  ...,  0.1731, -0.1564, -0.2780],
        ...,
        [ 0.0228, -0.0865,  0.0981,  ..., -0.0547, -0.2077, -0.2305],
        [-0.2891, -0.2029, -0.1525,  ...,  0.1042,  0.2041, -0.3528],
        [-0.0890, -0.0348, -0.2642,  ...,  0.2601, -0.0875, -0.5171]])
torch.Size([736389, 128])
labels
tensor([246, 131, 189,  ..., 266, 289,   1])
736389
g.ndata
tensor([1203354, 1203355, 1203356,  ..., 1939740, 1939741, 1939742])
{'_ID': tensor([1203354, 1203355, 1203356,  ..., 1939740, 1939741, 1939742]), '_TYPE': tensor([3, 3, 3,  ..., 3, 3, 3]), 'target_mask': tensor([True, True, True,  ..., True, True, True])}
--------------------------------------------------------------------------------start epoch  1
train nodes number of this epoch  2149639
------------------------------------------------------------------time -------------------------------train  4.709286212921143
--------------------------------------------------------------------------------start epoch  2
train nodes number of this epoch  2150619
------------------------------------------------------------------time -------------------------------train  3.6539621353149414
--------------------------------------------------------------------------------start epoch  3
train nodes number of this epoch  2151069
------------------------------------------------------------------time -------------------------------train  3.631911516189575
--------------------------------------------------------------------------------start epoch  4
train nodes number of this epoch  2150508
------------------------------------------------------------------time -------------------------------train  3.826545238494873
--------------------------------------------------------------------------------start epoch  5
train nodes number of this epoch  2149681
------------------------------------------------------------------time -------------------------------train  3.9013187885284424
--------------------------------------------------------------------------------start epoch  6
train nodes number of this epoch  2149441
------------------------------------------------------------------time -------------------------------train  3.8700003623962402
--------------------------------------------------------------------------------start epoch  7
train nodes number of this epoch  2149040
------------------------------------------------------------------time -------------------------------train  3.9010114669799805
--------------------------------------------------------------------------------start epoch  8
train nodes number of this epoch  2150604
------------------------------------------------------------------time -------------------------------train  3.688624382019043
--------------------------------------------------------------------------------start epoch  9
train nodes number of this epoch  2150463
------------------------------------------------------------------time -------------------------------train  3.7234976291656494
--------------------------------------------------------------------------------start epoch  10
train nodes number of this epoch  2151175
------------------------------------------------------------------time -------------------------------train  3.7462055683135986
--------------------------------------------------------------------------------start epoch  11
train nodes number of this epoch  2150563
------------------------------------------------------------------time -------------------------------train  3.8590292930603027
--------------------------------------------------------------------------------start epoch  12
train nodes number of this epoch  2149608
------------------------------------------------------------------time -------------------------------train  3.640530586242676
--------------------------------------------------------------------------------start epoch  13
train nodes number of this epoch  2150518
------------------------------------------------------------------time -------------------------------train  3.670656204223633
--------------------------------------------------------------------------------start epoch  14
train nodes number of this epoch  2149689
------------------------------------------------------------------time -------------------------------train  4.030674457550049
--------------------------------------------------------------------------------start epoch  15
train nodes number of this epoch  2149916
------------------------------------------------------------------time -------------------------------train  3.7079081535339355
--------------------------------------------------------------------------------start epoch  16
train nodes number of this epoch  2151171
------------------------------------------------------------------time -------------------------------train  3.8371849060058594
--------------------------------------------------------------------------------start epoch  17
train nodes number of this epoch  2150212
------------------------------------------------------------------time -------------------------------train  3.9599266052246094
--------------------------------------------------------------------------------start epoch  18
train nodes number of this epoch  2149221
------------------------------------------------------------------time -------------------------------train  3.6171343326568604
--------------------------------------------------------------------------------start epoch  19
train nodes number of this epoch  2150429
------------------------------------------------------------------time -------------------------------train  3.6933674812316895
--------------------------------------------------------------------------------start epoch  20
train nodes number of this epoch  2150007
------------------------------------------------------------------time -------------------------------train  3.8785414695739746
--------------------------------------------------------------------------------start epoch  21
train nodes number of this epoch  2150092
------------------------------------------------------------------time -------------------------------train  3.6296350955963135
--------------------------------------------------------------------------------start epoch  22
train nodes number of this epoch  2150832
------------------------------------------------------------------time -------------------------------train  3.7343413829803467
--------------------------------------------------------------------------------start epoch  23
train nodes number of this epoch  2150825
------------------------------------------------------------------time -------------------------------train  3.9657485485076904
--------------------------------------------------------------------------------start epoch  24
train nodes number of this epoch  2150157
------------------------------------------------------------------time -------------------------------train  3.841520071029663
--------------------------------------------------------------------------------start epoch  25
train nodes number of this epoch  2149301
------------------------------------------------------------------time -------------------------------train  3.7928683757781982
--------------------------------------------------------------------------------start epoch  26
train nodes number of this epoch  2149772
------------------------------------------------------------------time -------------------------------train  3.5125184059143066
--------------------------------------------------------------------------------start epoch  27
train nodes number of this epoch  2149768
------------------------------------------------------------------time -------------------------------train  3.9522409439086914
--------------------------------------------------------------------------------start epoch  28
train nodes number of this epoch  2150002
------------------------------------------------------------------time -------------------------------train  3.7499377727508545
--------------------------------------------------------------------------------start epoch  29
train nodes number of this epoch  2150199
------------------------------------------------------------------time -------------------------------train  3.584704875946045
--------------------------------------------------------------------------------start epoch  30
train nodes number of this epoch  2149941
------------------------------------------------------------------time -------------------------------train  3.7234549522399902
	total avg iteration(step) data from cpu to GPU time:0.69405468 s
	total avg iteration GPU training time:1.04113315 s
	total avg iteration (step) total CPU time:1.73655240 s
	total avg epoch total CPU time including train loader :3.77374516 s
	avg epoch nodes input :2150148.73333333 s
--------------------------------------------------------------------------------end training
time for training epoches
num of epoches  30
avg epoches training time  3.7748513797233842
